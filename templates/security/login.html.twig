{% extends 'base.html.twig' %}

{% block title %}
   Helder Camara Log in!
{% endblock %}

{% block body %}
    <!-- ===== Header Start ===== -->
    {% include "layout.html.twig" %}
    <!-- ===== Header End ===== -->
    <main>
        <!-- ===== SignIn Form Start ===== -->
        <section class="i pg fh rm ki xn vq gj qp gr hj rp hr">
            <!-- Bg Shapes -->
            <img src="{{ asset('images/shape-06.svg') }}" alt="Shape" class="h j k" />
            <img src="{{ asset('images/shape-03.svg') }}" alt="Shape" class="h l m" />
            <img src="{{ asset('images/shape-17.svg') }}" alt="Shape" class="h n o" />
            <img src="{{ asset('images/shape-18.svg') }}" alt="Shape" class="h p q" />

            <div class="animate_top bb af i va sg hh sm vk xm yi _n jp hi ao kp">
                <!-- Bg Border -->
                <div class="rj">
                    <h2 class="ek ck kk wm xb">
                        Connexion
                    </h2>
                    <p>
                        bienvenue sur votre espace de connexion, veuillez entrer vos identifiants pour accéder à votre compte.
                    </p>
                </div>

                <form class="sb" method="post">
                    {% if error %}
                        <div class="alert alert-danger">
                            {{ error.messageKey|trans(error.messageData, 'security')|replace({'Invalid credentials.': 'Identifiants invalides.'}) }}
                        </div>
                    {% endif %}

                    {% if app.user %}
                        <div class="mb-3">
                            Vous êtes connecté en tant que {{ app.user.userIdentifier }},
                            <a href="{{ path('app_logout') }}">Déconnexion</a>
                        </div>
                    {% endif %}

                    {# ✅ CORRECTION 1: name="email" → name="_email" #}
                    <div class="wb">
                        <label class="rc kk wm vb" for="inputEmail">
                            Email
                        </label>
                        <input type="email" 
                               name="_email" 
                               value="{{ last_username }}" 
                               id="inputEmail" 
                               placeholder="example@gmail.com" 
                               class="vd hh rg zk _g ch hm dm fm pl/50 xi mi sm xm pm dn/40" 
                               autocomplete="email" 
                               required 
                               autofocus />
                    </div>

                    {# ✅ CORRECTION 2: name="password" → name="_password" #}
                    <div class="wb">
                        <label class="rc kk wm vb" for="inputPassword">
                            Mot de passe
                        </label>
                        <input type="password" 
                               name="_password" 
                               id="inputPassword" 
                               placeholder="Votre mot de passe" 
                               class="vd hh rg zk _g ch hm dm fm pl/50 xi mi sm xm pm dn/40" 
                               autocomplete="current-password" 
                               required />
                    </div>

                    {# ✅ CORRECTION 3: SUPPRIMÉ le doublon CSRF #}
                    <input type="hidden" name="_csrf_token" value="{{ csrf_token('authenticate') }}">

                    <div class="checkbox mb-3">
                        <label>
                            <input type="checkbox" name="_remember_me">
                            Se souvenir de moi
                        </label>
                    </div>

                    <button class="vd rj ek rc rg gh lk ml il _l gi hi" type="submit">
                        Connexion
                    </button>

                    <p class="sj hk xj rj ob">
                        Pas de compte ?
                        <a class="mk" href="{{ path('app_register') }}">
                            S'inscrire
                        </a>
                    </p>
                </form>
            </div>
        </section>
        <!-- ===== SignIn Form End ===== -->
    </main>
    <!-- ===== FSM Start ===== -->
    {% include 'fsmlayout.html.twig' %}
    <!-- ===== FSM End ===== -->
    {% include 'footer.html.twig' %}
{% endblock %}
